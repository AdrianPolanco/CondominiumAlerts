  <p-toolbar styleClass="w-full flex justify-between p-1">
    <ng-template #start>
      <div class="flex justify-start items-center gap-6">
        <img
          ngSrc="images/condominiumAlertsLogo.jpg"
          alt="Condominium Alerts Logo"
          width="55"
          height="55"
        />
        <p class="text-lg font-bold m-0">{{ getLoggedUsername() }}</p>
      </div>
    </ng-template>
    <ng-template #end>
      <nav class="flex gap-7 items-center">
        <i class="pi pi-bell" style="font-size: 1.2rem" (click)="showNotificationsDialog()"></i>
        <a (click)="goHome()" class="font-bold">
          <p-button
            label="Cerrar sesiÃ³n"
            icon="pi pi-sign-out"
            class="mr-2"
            severity="danger"
          />
        </a>
      </nav>
    </ng-template>
  </p-toolbar>

  <p-drawer [(visible)]="showDrawer" header="Conversaciones">
    <div class="flex container-height">
      <div class="w-full p-5">
        <div class="text-lg font-semibold mb-4 text-center border-b pb-4 border-primary-200">
          Condominios
        </div>
        @if(areCondominiumsLoading()){
          <div class="flex justify-center items-center">
            <i class="pi pi-spin pi-spinner" styleClass="animate-[spin_3s_linear_infinite]" style="font-size: 2rem"></i>
          </div>
        }@else {
              <div
                *ngFor="let condominium of condominiums$ | async"
                class="flex items-center space-x-3 cursor-pointer p-3 rounded-lg transition-all duration-200 hover:bg-gray-50"
                [ngClass]="{ 'bg-gray-50': currentCondominium?.id === condominium.id }"
                (click)="onCondominiumSelected(condominium)">
                <img
                  [ngSrc]="condominium.imageUrl"
                  alt="Condominium Profile picture"
                  width="80"
                  height="80"
                  class="rounded-full"
                />
                <div class="flex flex-col">
                  <p class="font-semibold">{{ condominium.name | titlecase }}</p>
                  <p class="text-sm text-gray-400">{{ condominium.address | titlecase }}</p>
                </div>
              </div>
        }

        <div class="text-lg font-semibold mb-4 text-center border-b pb-4 border-primary-200">
          Contactos
        </div>
        <!--<div
          *ngFor="let user of users"
          class="flex items-center space-x-3 cursor-pointer p-3 rounded-lg transition-all duration-200"
          [ngClass]="{ 'bg-gray-700': currentUser?.id === user.id }"
          (click)="goToChat(user)"
        >
          <img
            [ngSrc]="user.profilePictureUrl"
            alt="User Profile picture"
            width="40"
            height="40"
            class="rounded-full"
          />
          <div class="flex flex-col">
            <p class="font-semibold">{{ user.fullName }}</p>
            <p class="text-sm text-gray-400">{{ user.email }}</p>
          </div>
        </div>-->
      </div>
    </div>
  </p-drawer>
  <div class="flex-1 bg-gray-900 h-svh">
    <!--<div (click)="showDrawerDialog()" class="fixed bottom-5 right-5 rounded-full shadow-md p-1 transition bg-white h-14 w-14 flex justify-center items-center cursor-pointer text-sm">
      <div class="flex items-center justify-center bg-primary p-1 rounded">
        <i class="pi pi-align-left text-white" style="font-size: 1.7rem"></i>
      </div>
    </div>-->
    <p-button 
      (click)="showDrawerDialog()"
      icon="pi pi-align-left" 
      class=""
      styleClass="fixed bottom-16 right-5 text-transparent hover:text-white rounded-full shadow-lg p-3 transition 
      bg-transparent hover:bg-primary hover:shadow-xl hover:text-white"/>
    <!--TODO: Add the same logic here when working with individual user chat-->
    @if(!currentCondominium){
      <section class="bg-gray-50 h-full w-full">
        <div class="flex justify-center items-center h-full">
          <p class="text-lg text-gray-400">Selecciona un condominio o un contacto para comenzar a chatear</p>
        </div>
      </section>
    }@else{
      <ng-content></ng-content>
    }
  </div>

  <p-dialog header="Notificaciones" [modal]="true" [(visible)]="showNotifications" [style]="{ width: '50rem' }" [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" [maximizable]="true">
    <div class="w-50 p-5">
      <div *ngFor="let notification of notifications" class="mb-3">
        <div class="flex items-center space-x-2">
          <i class="pi pi-bell text-red-500"></i>
          <p class="text-sm">{{ notification.message }}</p>
        </div>
        <span class="text-xs text-gray-400">{{ notification.time }}</span>
      </div>
    </div>
  </p-dialog>

